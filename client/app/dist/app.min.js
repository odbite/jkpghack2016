"use strict";angular.module("navotron.templates",["js/components/knowme/knowme.jade","js/components/navbar/navbar.jade","js/components/utils/modifyField/modifyFieldView.jade","js/components/utils/notification/notification.jade","js/main.jade"]),angular.module("js/components/knowme/knowme.jade",[]).run(["$templateCache",function(a){a.put("js/components/knowme/knowme.jade",'<ui-gmap-google-map center="map.center" zoom="map.zoom"></ui-gmap-google-map>')}]),angular.module("js/components/navbar/navbar.jade",[]).run(["$templateCache",function(a){a.put("js/components/navbar/navbar.jade",'<nav role="navigation" style="padding-top: 7px; height: 59px" class="navbar navbar-default navbar-custom"><div ng-controller="navbarController as ctrl" class="container-fluid"><div class="navbar-header col-md-12 text-center"><a ui-sref="root" style="font-size: 30px"><span style="color: #56AAF4">Have</span><span style="color: #00B500; margin: 4px">you</span><span style="color: #56AAF4">met</span><span style="color: #00B500; margin: 4px">me</span></a></div></div></nav>')}]),angular.module("js/components/utils/modifyField/modifyFieldView.jade",[]).run(["$templateCache",function(a){a.put("js/components/utils/modifyField/modifyFieldView.jade",'<span ng-hide="editField" ng-click="edit()">{{ field }}</span> <input type="{{ type }}" ng-show="editField" ng-model="newValue" ng-blur="onBlur()" to-select="editField" on-blur="save()" on-enter-press="save()" class="form-control input-sm">')}]),angular.module("js/components/utils/notification/notification.jade",[]).run(["$templateCache",function(a){a.put("js/components/utils/notification/notification.jade",'<div class="notification-container"><div ng-repeat="alert in messages" ng-class="alert.alertClass" ng-show="$index === 0" class="alert">{{ alert.message }} <button type="button" ng-click="messages.splice($index, 1)" class="close"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button></div></div>')}]),angular.module("js/main.jade",[]).run(["$templateCache",function(a){a.put("js/main.jade",'<div ui-view="header"></div><div ui-view="main"></div><div ui-view="footer"></div>')}]),angular.module("navotron.config",["navotron.notification"]).config(["$httpProvider","notificationProvider","oauth2Provider",function(a,b,c){a.defaults.cache=!1,b.setTimeout(8e3),c.setClientDetails({url:"/oauth2/token/",clientId:"qT.pfokMO=1X.j6Pz4jB4L-.P_S1O9abTiFoqPj9",clientSecret:"YeFV?UweZ6P!oeVFFIPN5NkicXB8tHFh@PC0ACZF@htyF4gxcb8iDd?VC2;E3bpkP_.ApQob!JtwolA0FJDc-DBzAHDZ8?dnmCMsMc1qTM8TcB!0C!.q?TYjpswEo2MX"})}]),angular.module("navotron.constants",[]).constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{all:"*",admin:"admin",editor:"editor"}),angular.module("navotron",["navotron.api","navotron.authService","navotron.broadcastInterceptor","navotron.config","navotron.run","navotron.constants","navotron.datadef","navotron.directives","navotron.navbar","navotron.notification","navotron.routes","navotron.session","navotron.templates","navotron.knowme","angular-extend-promises","ngAnimate","ui.router","ui.bootstrap","uiGmapgoogle-maps"]),angular.module("navotron.routes",["ui.router"]).config(["$stateProvider","$urlRouterProvider","USER_ROLES",function(a,b,c){b.otherwise("/"),a.state("root",{url:"/",views:{"@":{templateUrl:"js/main.jade"},"header@root":{template:"<navbar></navbar>"},"main@root":{template:"<knowme></knowme>"},"footer@root":{template:""}}})}]),angular.module("navotron.run",["navotron.api","navotron.constants","navotron.notification"]).run(["$rootScope","$state","notification","api","AUTH_EVENTS",function(a,b,c,d,e){a.$on(e.loginSuccess,function(a,c){b.go("root",{},{reload:!0})}),a.$on(e.logoutSuccess,function(a,c){b.go("root.login",{},{reload:!0})}),a.$on(e.sessionTimeout,function(a,c){d.users.logoutUser(),b.go("root.login",{},{reload:!0})}),a.$on(e.notAuthorized,function(a,d){c.info("You do not have privilages to access that view."),b.go("root.login",{},{reload:!0})}),a.$on(e.notAuthenticated,function(a,c){d.users.logoutUser(),b.go("root.login")})}]),angular.module("navotron.apiAnimals",["navotron.cache"]).factory("animals",["$http","cache",function(a,b){return{post:function(c){return b.destroy(),a.post(Urls.workarea_list(),c).then(function(a){return a.data})},patch:function(c,d){return b.destroy(),a.patch(Urls.workarea_detail(c),d).then(function(a){return a.data})},put:function(c,d){return b.destroy(),a.put(Urls.workarea_detail(c),d).then(function(a){return a.data})},"delete":function(c){return b.destroy(),a["delete"](Urls.workarea_detail(c))},get:function(){return a.get(Urls.workarea_list(),{cache:b.get()}).then(function(a){return a.data})},getOne:function(c){return a.get(Urls.workarea_detail(c),{cache:b.get()}).then(function(a){return a.data})}}}]),angular.module("navotron.api",["navotron.apiAnimals"]).factory("api",["animals",function(a){return{animals:a}}]),angular.module("navotron.authService",["navotron.authOauth2"]).factory("authService",["oauth2","tokens",function(a,b){return{logoutUser:function(){b.destroy(),b.load()},loginUser:function(b,c){return a.login(b,c)},isAuthenticated:function(){return!!b.accessToken}}}]),angular.module("navotron.authOauth2",["LocalStorageModule"]).provider("oauth2",function(){function a(a){var b=[];for(var c in a)b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}var b,c,d;this.setClientDetails=function(a){d=a.url,b=a.clientId,c=a.clientSecret},this.$get=["$http","tokens",function(e,f){function g(b){return e({method:"POST",url:d,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a(b)}).then(function(a){return f.create(a.data.access_token,a.data.refresh_token,a.data.expires_in),a})}return{login:function(a,d){return g({grant_type:"password",client_id:b,client_secret:c,username:a,password:d})},refresh:function(){var a=f.refreshToken;return f.destroy(),g({grant_type:"refresh_token",client_id:b,client_secret:c,refresh_token:a})},refreshRequired:function(){return f.accessToken?f.expiryDate<=Math.floor(Date.now()/1e3):!1}}}]}).service("tokens",["localStorageService",function(a){this.load=function(){this.accessToken=a.get("accessToken"),this.refreshToken=a.get("refreshToken"),this.expiryDate=a.get("expiryDate")},this.create=function(b,c,d){var e=Math.floor(Date.now()/1e3)+d;a.set("accessToken",b),a.set("refreshToken",c),a.set("expiryDate",e),this.load()},this.destroy=function(){a.remove("accessToken"),a.remove("refreshToken"),a.remove("expiryDate"),this.load()},this.load()}]).factory("tokenInterceptor",["$injector","tokens",function(a,b){return{request:function(c){if(null!==b.accessToken&&angular.extend(c.headers,{Authorization:"Bearer "+b.accessToken}),"/oauth2/token/"!==c.url){var d=a.get("oauth2");if(d.refreshRequired())return d.refresh().then(function(){return c})}return c}}}]).config(["$httpProvider",function(a){a.interceptors.push("tokenInterceptor")}]),angular.module("navotron.knowme",["navotron.api"]).directive("knowme",function(){return{restrict:"E",templateUrl:"js/components/knowme/knowme.jade",scope:{},controller:["$scope","$state",function(a,b){a.map={center:{latitude:45,longitude:-73},zoom:8}}]}}),angular.module("navotron.navbar",["navotron.api"]).controller("navbarController",["$state","api",function(a,b){this.users=b.users,this.includes=a.includes}]).directive("navbar",function(){return{restrict:"E",templateUrl:"js/components/navbar/navbar.jade"}}),angular.module("navotron.broadcastInterceptor",["navotron.constants"]).factory("broadcastInterceptor",["$rootScope","$q","AUTH_EVENTS",function(a,b,c){return{responseError:function(d){return a.$broadcast({401:c.notAuthenticated,403:c.notAuthorized,419:c.sessionTimeout,440:c.sessionTimeout}[d.status],d),b.reject(d)}}}]).config(["$httpProvider",function(a){a.interceptors.push("broadcastInterceptor")}]),angular.module("navotron.cache",[]).service("cache",["$cacheFactory","session",function(a,b){this.get=function(){return void 0===a.get(b.user.id)?a(b.user.id):a.get(b.user.id)},this.destroy=function(){a.get(b.user.id).removeAll()}}]),angular.module("navotron.directives",[]).directive("toSelect",["$timeout",function(a){return function(b,c,d){b.$watch(d.toSelect,function(b){b&&a(function(){c[0].select()},0,!1)})}}]).directive("onBlur",["$parse",function(a){return function(b,c,d){var e=a(d.onBlur);c.bind("blur",function(a){b.$apply(function(){e(b,{$event:a})})})}}]).directive("onEnterPress",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.onEnterPress,{event:b})}),b.preventDefault())})}}).directive("onEscPress",function(){return function(a,b,c){b.bind("keydown keypress",function(b){27===b.which&&(a.$apply(function(){a.$eval(c.onEscPress,{event:b})}),b.preventDefault())})}}),angular.module("navotron.modifyField",[]).directive("modifyField",["$timeout","$animate","modifyFieldFactory",function(a,b,c){return{restrict:"E",transclude:!1,scope:{field:"=",type:"=",onSave:"&",onBlur:"&"},templateUrl:"js/components/utils/modifyField/modifyFieldView.jade",link:function(a,c,d){b.enabled(!1,c)},controller:["$scope",function(a){a.editField=!1,a.edit=function(){a.newValue=a.field,a.editField=!0},a.save=function(){if(c.isNewValue(a.newValue,a.field)){var b=c.save(a.newValue,a.field,a.onSave);b.then(function(b){a.field=a.newValue})}a.editField=!1}}]}}]).service("modifyFieldFactory",function(){var a=this;a.save=function(a,b,c){return c({newVal:a,oldVal:b})},a.isNewValue=function(a,b){return angular.equals(a,b)?!1:a!==b}}),angular.module("navotron.notification",[]).directive("ntNotification",["notification",function(a){return{restrict:"E",scope:{},templateUrl:"js/components/utils/notification/notification.jade",link:function(b,c,d){b.messages=a.messages}}}]).provider("notification",function(){var a=[],b=5e3;this.setTimeout=function(a){b=a},this.$get=["$timeout",function(c){function d(d,e){a.push({message:d,alertClass:e}),c(function(){a.shift()},b)}return{info:function(a){d(a,"alert-info")},success:function(a){d(a,"alert-success")},error:function(a,b){d(a+" Status: "+b.status+" ErrorMsg: "+b.statusText,"alert-danger")},messages:a}}]});var Pagination=function(){function a(a,b){var c=this;this.refresh=function(){return c._get(c.params)},this.setParam=function(a,b){c.params[a]=b},this.unsetParam=function(a){delete c.params[a]},this._get=function(a){return c.loading=!0,c.$http({method:"GET",url:c.baseUrl,params:a}).then(c._success)},this._success=function(a){return c.loading=!1,c.response=a,c.results=c.response.data.results,a},this.$http=a,this.response=null,this.params={},this.baseUrl=b,this.loading=!1,this.results=[]}return a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},stPagination=function(a){function b(b,c){var d=this;a.call(this,b,c),this.callServer=function(a){d.tableState=a,d.setOffsetParams(),d.setOrderingParams(),d.setSearchParams(),d.refresh().then(function(){d.tableState.pagination.numberOfPages=d.numberOfPages})},this.setOffsetParams=function(){d.setParam("limit",d.tableState.pagination.number||10),d.setParam("offset",d.tableState.pagination.start||0)},this.setOrderingParams=function(){var a=d.tableState.sort;if(void 0!==a.predicate){var b=a.reverse?"-":"";d.setParam("ordering",b+a.predicate)}else d.unsetParam("ordering")},this.setSearchParams=function(){var a=d.tableState.search.predicateObject;void 0!==a?d.setParam("search",a.search):d.unsetParam("search")},this.setParam("limit",10)}return __extends(b,a),Object.defineProperty(b.prototype,"numberOfPages",{get:function(){return null===this.response?0:null===this.tableState?0:Math.ceil(this.response.data.count/this.tableState.pagination.number)},enumerable:!0,configurable:!0}),b}(Pagination);angular.module("navotron.pagination",[]).factory("stPagination",["$http",function(a){return function(b){return new stPagination(a,b)}}]),angular.module("navotron.session",["LocalStorageModule"]).service("session",["localStorageService",function(a){this.load=function(){this.user=a.get("user"),this.activeNode=a.get("activeNode"),this.activeWorkArea=a.get("activeWorkArea")},this.set=function(b,c){a.set(b,c),this.load()},this.destroy=function(){a.remove("user"),this.activeNode=a.get("activeNode"),a.remove("activeWorkArea")},this.hasSetProperty=function(b){return null!==a.get(b)},this.load()}]),angular.module("navotron.datadef",[]).factory("datadef",function(){var a={};return a.SP1={search:"",ordering:"",limit:"",offset:""},a.SP2={search:"",ordering:"name",limit:"0",offset:"10"},a.SP3={search:"",ordering:"-name",limit:"10",offset:"10"},a.SP4={search:"linu",ordering:"name",limit:"10",offset:"100"},a.RURL_WORKAREA_LIST="/workareas",a.RURL_WORKAREA_DETAIL="/workareas/123",a.RURL_NODE_LIST="/workareas/123/nodes",a.RURL_NODE_DETAIL="/workareas/123/nodes/123",a.RURL_NODE_LIST="/workareas/123/nodes",a.RURL_NODE_DETAIL="/workareas/123/nodes/123",a.WA1={hash_id:"asdasd",site_url:"http://linus-little-haven.se",owner:1,country:"SE"},a.WA2={hash_id:"fwergwvfd",site_url:"http://my-special-place.se",owner:1,country:"SE"},a.WA3={hash_id:"asdascdscae",site_url:"http://the-rankor-cave.se",owner:2,country:"SE"},a.HTML1=$.parseHTML(["<ul>",'<li id="1" name="Home">',"<div>Home</div>","</li>",'<li id="5" name="Category">',"<div>Category</div>","<span>","<ul>",'<li id="2" name="Produkt 1">',"<div>Produkt 1</div>","</li>",'<li id="3" name="Product 2">',"<div>Product 2</div>","</li>",'<li id="4" name="Product 3">',"<div>Product 3</div>","</li>","</ul>","</span>","</li>","</ul>"].join("\n")),a.SQ1={keywords:["vår","fast elpris","elavtal"],country:"se",limit:100},a.SQ2={keywords:["party","moped"],country:"en",limit:100},a.SQ3={keywords:["i_do_not_exist_as_a_keyword","neither_do_I_my_friend"],country:"en",limit:100},a.SV1={volume:5400,timestamp:"2014-08-01",country:"EN",keyword:"comics"},a.SV2={volume:9900,timestamp:"2014-08-01",country:"EN",keyword:"comic"},a.SV3={volume:9900,timestamp:"2014-08-01",country:"EN",keyword:"batman comic"},a.SV4={volume:70,timestamp:"2014-08-01",country:"EN",keyword:"green lantern comic"},a.SV5={volume:390,timestamp:"2014-08-01",country:"EN",keyword:"superman comic"},a.SVR1={results:[a.SV1,a.SV2,a.SV3],total:3,took:2},a.SVR2={results:[],total:0,took:2},a.N1={id:"1",index:0,parentNode:null,workarea:"1",name:"Home",children:[],keywords:[]},a.N2={id:"2",index:0,parentNode:5,workarea:"1",name:"Superman",children:[],keywords:[a.SV5]},a.N3={id:"3",index:1,parentNode:5,workarea:"1",name:"Batman",children:[],keywords:[a.SV3]},a.N4={id:"4",index:2,parentNode:5,workarea:"1",name:"Green Lantern",children:[],keywords:[a.SV4]},a.N5={id:"5",index:1,parentNode:null,workarea:"1",name:"Comics",children:[a.N2,a.N3,a.N4],keywords:[a.SV1,a.SV2]},a.N6={id:"6",index:2,parentNode:null,workarea:"1",name:"About us",children:[],keywords:[]},a.N7={id:"7",index:3,parentNode:null,workarea:"1",name:"Contact us",children:[],keywords:[]},a});